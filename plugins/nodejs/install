#!/usr/bin/env bash

set -euo pipefail

source "$(dirname "$0")/../../framework"

main() {
  if is_termux; then
    apt-fast-install nodejs-lts
  elif [ "$DOTF_CONFIG_NODE_PROVIDER" = "n" ]; then
    git_clone https://github.com/tj/n "$N_PREFIX"
    install_node
  else
    apt-fast-install nodejs npm
  fi

  install_packages
}

install_node() {
  if [[ ! "$(n ls)" =~ 'Î¿' ]]; then
    n 11
  fi
}

install_packages() {
  npm-fast-install yarn json live-server eslint typescript prettier \
    semver cloc fx

  if ! is_termux; then
    npm-fast-install gtop
  fi
}

main "$@"
